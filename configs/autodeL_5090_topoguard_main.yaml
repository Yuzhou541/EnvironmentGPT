seed: 42

model:
  name_or_path: "REPLACE_ME"
  load_in_4bit: true
  torch_dtype: "bfloat16"
  attn_implementation: "sdpa"

data:
  train_path: "data/processed/envqa_train.jsonl"
  dev_path: "data/processed/envqa_dev.jsonl"
  general_path: "data/processed/general_anchors.jsonl"
  max_length: 2048

train:
  output_dir: "outputs/topoguard_main"
  num_train_epochs: 3
  per_device_train_batch_size: 2
  gradient_accumulation_steps: 8
  learning_rate: 1.5e-4
  warmup_ratio: 0.03
  max_grad_norm: 1.0
  logging_steps: 10
  eval_steps: 200
  save_steps: 200
  save_total_limit: 3

method:
  name: "topoguard"
  lora_r: 16
  lora_alpha: 32
  lora_dropout: 0.05
  target_modules: ["q_proj","k_proj","v_proj","o_proj","up_proj","down_proj","gate_proj"]

topoguard:
  l0_lambda: 1.0e-4
  route_lambda: 1.0e-3
  kd_lambda: 1.0
  kd_temperature: 1.0
  geom_lambda: 0.2
  geom_layer: -1
  geom_metric: "cosine"
